<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AXAPTA Invoice FAQs â€” Premium FAQ</title>
<style>
  :root{
    --bg: #fffaf9;
    --card: #ffffff;
    --text: #111827;
    --muted: #6b7280;
    --accent: #8b0000; /* deep maroon */
    --accent-2: #b22222;
    --border: #e6e6e6;
    --glass: rgba(255,255,255,0.7);
    --radius: 12px;
    --shadow: 0 6px 20px rgba(11,15,20,0.08);
  }
  .dark{
    --bg: #0b0f12;
    --card: #0f1720;
    --text: #e6eef6;
    --muted: #9aa7b8;
    --accent: #b22222;
    --accent-2: #8b0000;
    --border: rgba(255,255,255,0.06);
    --glass: rgba(16,22,26,0.6);
    --shadow: 0 8px 30px rgba(0,0,0,0.6);
  }

  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;color:var(--text);background:var(--bg);-webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale}
  a{color:inherit}

  /* Layout */
  .layout{display:flex;min-height:100vh;gap:28px;padding:28px}
  /* Sidebar */
  .sidebar{
    width:300px;
    flex:0 0 300px;
    background:linear-gradient(180deg,var(--card),var(--glass));
    border-radius:var(--radius);
    padding:22px;
    box-shadow:var(--shadow);
    border:1px solid var(--border);
    position:sticky;top:24px;height:calc(100vh - 48px);overflow:auto;
  }
  .brand{display:flex;align-items:center;gap:12px;margin-bottom:18px}
  .brand img{width:46px;height:46px;object-fit:contain;cursor:pointer;border-radius:8px}
  .brand h1{font-size:16px;margin:0;font-weight:700;color:var(--accent)}
  .home-btn{margin-left:auto;background:transparent;border:1px solid var(--border);padding:6px 10px;border-radius:999px;font-weight:600;color:var(--muted);cursor:pointer}
  .search{margin-top:14px}
  .search input{
    width:100%;padding:12px 14px;border-radius:10px;border:1px solid var(--border);outline:none;background:transparent;color:var(--text);
    font-size:14px;
  }
  .topics{margin-top:18px}
  .topics a{display:block;padding:10px 12px;border-radius:8px;text-decoration:none;color:var(--accent);font-weight:700;margin-bottom:8px;border:1px dashed transparent}
  .topics a:hover{background:rgba(0,0,0,0.03)}
  .meta{font-size:13px;color:var(--muted);margin-top:10px}

  /* Main */
  .main{
    flex:1 1 auto;
    max-width:1000px;
    min-width:0;
  }
  header.main-head{
    display:flex;align-items:center;gap:18px;margin-bottom:20px;
  }
  .title {
    display:flex;flex-direction:column;
  }
  .title h2{margin:0;font-size:20px;color:var(--accent);letter-spacing:0.2px}
  .title p{margin:2px 0 0;color:var(--muted);font-size:13px}

  .controls{margin-left:auto;display:flex;gap:12px;align-items:center}
  .toggle{
    background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;padding:8px 12px;border-radius:999px;border:none;font-weight:700;cursor:pointer;box-shadow:0 6px 18px rgba(139,0,0,0.18)
  }
  .btn-ghost{background:transparent;border:1px solid var(--border);padding:8px 12px;border-radius:10px;color:var(--muted);cursor:pointer}

  /* FAQ grid */
  .faq-wrap{display:grid;grid-template-columns:1fr;gap:16px}
  .card{
    background:var(--card);border-radius:12px;padding:18px;border:1px solid var(--border);box-shadow:var(--shadow);transition:transform .18s ease,box-shadow .18s ease;
    cursor:default;
  }
  .card:hover{transform:translateY(-4px)}
  .q{display:flex;align-items:flex-start;gap:12px}
  .q h3{margin:0;font-size:16px;color:var(--accent)}
  .q p{margin:6px 0 0;color:var(--muted);font-size:14px}

  /* Accordion */
  .answer{margin-top:12px;display:none;color:var(--text);line-height:1.55}
  .open .answer{display:block}
  .meta-line{font-size:13px;color:var(--muted);margin-top:10px}

  /* back to top */
  #topBtn{position:fixed;right:28px;bottom:28px;background:var(--accent);color:#fff;border:none;padding:12px 14px;border-radius:999px;cursor:pointer;box-shadow:0 10px 30px rgba(0,0,0,0.25);display:none;font-weight:700}

  /* small screens */
  @media (max-width:900px){
    .layout{flex-direction:column;padding:18px}
    .sidebar{width:100%;height:auto;position:relative}
    .main{max-width:100%}
    .controls{margin-top:8px}
  }

  /* subtle animations */
  .fade-up{opacity:0;transform:translateY(10px);animation:fadeUp .45s ease forwards}
  @keyframes fadeUp{to{opacity:1;transform:none}}
  .chev{margin-left:auto;color:var(--muted);font-weight:700}
</style>
</head>
<body>

<div class="layout" id="app">
  <!-- SIDEBAR -->
  <aside class="sidebar fade-up" role="navigation" aria-label="FAQ sidebar">
    <div class="brand">
      <img id="brandLogo" src="/mnt/data/1024px-Menarini.svg.png" alt="Company logo (click to go Home)" title="Home (click)" />
      <div style="flex:1">
        <h1>AXAPTA â€“ Invoice FAQs</h1>
        <div class="meta">Quick answers for AP / Invoice posting & interface issues</div>
      </div>
      <button class="home-btn" id="sidebarHome">Home</button>
    </div>

    <div class="search">
      <input id="search" type="search" placeholder="Search questions or keywords..." aria-label="Search FAQs" />
    </div>

    <nav class="topics" aria-label="FAQ topics">
      <!-- anchor links will be populated by JS for smooth scroll -->
    </nav>

    <div class="meta" style="margin-top:18px;">
      Theme: <strong style="color:var(--accent)">(Maroon)</strong><br>
      Dark mode: <strong>enabled</strong>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main" role="main">
    <header class="main-head fade-up">
      <div class="title">
        <h2>AXAPTA Invoice Processing â€” FAQs</h2>
        <p>Comprehensive troubleshooting & steps for common AX interface errors</p>
      </div>

      <div class="controls" role="region" aria-label="controls">
        <button class="btn-ghost" id="homeTop">Home</button>
        <button id="darkToggle" class="toggle" title="Toggle dark mode">ðŸŒ™ Dark Mode</button>
      </div>
    </header>

    <section id="faqs" class="faq-wrap">
      <!-- FAQ cards inserted by JS -->
    </section>

    <div style="margin-top:12px;color:var(--muted);font-size:13px;">
      FAQs content sourced from your document. :contentReference[oaicite:2]{index=2}
    </div>
  </main>
</div>

<button id="topBtn" title="Back to top">â†‘ Top</button>

<script>
/* ---------- Data: converted from AX FAQs.docx ---------- */
/* Each item: {id, q, a: array of paragraphs} */
const faqs = [
  {
    id: "q-where-validated",
    q: "Where are validated invoices routed once they have been successfully exported from IM-OCR to AX?",
    a: [
      "Invoices that are successfully exported from IM-OCR will interface into AX through the following journals:",
      "â€¢ Invoice Journal for non-PO invoices",
      "â€¢ Invoice Approval Journal for PO invoices"
    ]
  },
  {
    id: "q-restore-cancelled",
    q: "What should I do if I accidentally cancelled an invoice in the Invoice Approval Journal?",
    a: [
      "To restore the invoice:",
      "1. Open the Invoice Approval Journal.",
      "2. Select the invoice cancelled.",
      "3. Click Lines then Remove voucher.",
      "4. Confirm by selecting Yes.",
      "5. Fetch voucher.",
      "6. Click Select then OK to complete the process."
    ]
  },
  {
    id: "q-insufficient-info",
    q: "What does the error message â€œInsufficient information / Intercompany posting missing / Update canceledâ€ mean in AX?",
    a: [
      "This error appears when AX is unable to post an invoice due to missing or incorrect data in the voucher. Common Infolog messages:",
      "â€¢ â€œInsufficient information in a line in voucher â€¦â€ â€“ Required fields (ledger account, offset account, financial dimensions) are missing.",
      "â€¢ â€œIntercompany posting with th91 missing.â€ â€“ Intercompany setup incomplete or a required dimension value is not defined/mapped.",
      "â€¢ â€œJournal has not been posted / Update has been canceled because of an error.â€ â€“ Posting stopped due to validation failure.",
      "Resolution: Ensure all mandatory fields and dimensions are populated, check intercompany account mappings and required dimensions. If unresolved, contact the AX support team."
    ]
  },
  {
    id: "q-no-budget",
    q: "To whom should I coordinate if a â€œno budgetâ€ error occurs during invoice posting?",
    a: [
      "Coordinate with the Requestors or Marketing Coordinators so they can top up the budget. Once the budget has been updated, proceed to post the invoice."
    ]
  },
  {
    id: "q-invoice-higher-than-grn",
    q: "How do I handle an invoice in AX when the invoice amount is higher than the PO GRN amount?",
    a: [
      "Ask the requestor to create an additional Purchase Order (PO) for the excess amount. Once provided, follow these steps:",
      "1. Go to the Invoice Approval Journal in AX.",
      "2. Select Functions â†’ Purchase Order.",
      "3. Click the Select tab.",
      "4. Tick the additional PO number and arrange sequence as needed.",
      "Then post the invoice successfully."
    ]
  },
  {
    id: "q-inventitemprice",
    q: "What does the error \"Cannot create a record in Price (InventItemPrice). Item Number RBMENSYMVN006.\" mean in AX?",
    a: [
      "This means AX cannot create or update a price record for the specified item. Common causes:",
      "â€¢ Item number does not exist or is inactive.",
      "â€¢ Pricing setup (price groups / UoM) missing or incorrect.",
      "â€¢ Insufficient user permissions to create/modify price records.",
      "Resolution: Raise to the AX support team as the Finance team likely lacks access to change item setup."
    ]
  },
  {
    id: "q-ledger-incorrect",
    q: "The ledger account tagged in the PO is incorrect; how can I correct it during invoice posting?",
    a: [
      "To correct the ledger account during invoice posting:",
      "1. Go to the Invoice Approval Journal in AX.",
      "2. Click Lines and select the invoice to post.",
      "3. Navigate to the Information tab.",
      "4. For Opex accounts, enter the correct ledger account in the Ledger Account field.",
      "5. For A&M, enter the correct ledger account in the Category field."
    ]
  },
  {
    id: "q-po-dimension-mismatch",
    q: "What should I do if the PO dimension does not match the project master in AX?",
    a: [
      "Requestors should:",
      "â€¢ Verify project dimensions in the project master.",
      "â€¢ Update the PO line with the correct project / financial dimensions to match the project master (Cost Center, Department, Project ID).",
      "If mismatch persists, escalate to the AX support team for administrative assistance."
    ]
  },
  {
    id: "q-not-in-journal",
    q: "Where can I find an invoice exported from IM-OCR to AX if it does not appear in the Invoice Journal or Invoice Approval Journal?",
    a: [
      "If not visible, it may not have interfaced successfully. To locate it:",
      "â€¢ Check the Invoice Processing Log in AX (AP Invoice Processing Log for Non-PO; PO Invoice Processing Log for PO invoices).",
      "â€¢ Status values: Created (generated, not posted), Failed (error during interface).",
      "â€¢ If Failed, identify error details in the log and correct any missing/invalid information, then re-process.",
      "â€¢ If still missing, contact AX support."
    ]
  },
  {
    id: "q-closed-period",
    q: "What should I do if the invoice cannot be posted in AX due to a closed period?",
    a: [
      "Check the posting date used for the invoice in AX. Update the posting date to a date within an open period and attempt to post again."
    ]
  },
  {
    id: "q-po-invalid",
    q: "How do I resolve the AX interface error â€œLine Item 1.00 â€“ PO Number NPOXX-00XXX is invalidâ€?",
    a: [
      "This happens when the PO number captured in IM-OCR does not match a valid PO in AX. To resolve:",
      "â€¢ Verify the PO number on the invoice matches exactly the PO in AX.",
      "â€¢ Confirm PO exists in AX, is open and not cancelled.",
      "â€¢ If correct but still invalid, it may be a setup issueâ€”escalate to AX support.",
      "â€¢ Note: To prevent this interface error, item number in IM-OCR may need manual update."
    ]
  },
  {
    id: "q-dimension-error",
    q: "How do I resolve a dimension error such as â€œBusiness Line/PRIN-PROD combination failing financial dimensionâ€ in AX?",
    a: [
      "This occurs when financial dimensions on the PO line don't match allowed combinations. To resolve:",
      "â€¢ Check financial dimensions (Business Line, PRIN, Product, Cost Center).",
      "â€¢ Verify the dimension combination against defined rules.",
      "â€¢ Update the PO line with the correct combination and re-process the invoice from the Invoice Processing Log."
    ]
  },
  {
    id: "q-material-invalid",
    q: "How do I resolve the AX interface error â€œMaterial Number is invalidâ€?",
    a: [
      "â€¢ Verify material/item number on the invoice and ensure it is correctly encoded in IM-OCR.",
      "â€¢ Check if the item number exists and is active in AX.",
      "â€¢ If the number should be valid but errors persist, the item master setup may be incompleteâ€”raise to AX support.",
      "â€¢ During validation, if unsure of the material number, leave the field blank to avoid this error."
    ]
  }
];

/* ---------- Render topics & faq cards ---------- */
const topicsEl = document.querySelector('.topics');
const faqsEl = document.getElementById('faqs');

function renderAll(){
  topicsEl.innerHTML = '';
  faqsEl.innerHTML = '';
  faqs.forEach(item=>{
    // sidebar link
    const link = document.createElement('a');
    link.href = '#'+item.id;
    link.textContent = item.q;
    link.onclick = e => {
      e.preventDefault();
      document.getElementById(item.id).scrollIntoView({behavior:'smooth', block:'start'});
    };
    topicsEl.appendChild(link);

    // card
    const card = document.createElement('article');
    card.className = 'card';
    card.id = item.id;

    const qWrap = document.createElement('div');
    qWrap.className = 'q';
    const h = document.createElement('h3');
    h.textContent = item.q;
    qWrap.appendChild(h);

    const chev = document.createElement('div');
    chev.className = 'chev';
    chev.innerHTML = 'â–¸';
    qWrap.appendChild(chev);

    card.appendChild(qWrap);

    const summary = document.createElement('p');
    summary.className = 'meta-line';
    summary.textContent = item.a.slice(0,1).join(' ');
    card.appendChild(summary);

    const ans = document.createElement('div');
    ans.className = 'answer';
    item.a.forEach(p=>{
      const pp = document.createElement('p');
      pp.style.margin='8px 0';
      pp.textContent = p;
      ans.appendChild(pp);
    });
    card.appendChild(ans);

    // toggle open
    card.addEventListener('click', (ev)=>{
      // ignore clicks on links (if any)
      if(ev.target.tagName.toLowerCase()==='a') return;
      const isOpen = card.classList.toggle('open');
      chev.innerHTML = isOpen ? 'â–¾' : 'â–¸';
      // smooth scroll small offset
      if(isOpen) card.scrollIntoView({behavior:'smooth', block:'center'});
    });

    faqsEl.appendChild(card);
  });
}
renderAll();

/* ---------- Search ---------- */
const search = document.getElementById('search');
search.addEventListener('input', e=>{
  const term = e.target.value.trim().toLowerCase();
  document.querySelectorAll('#faqs .card').forEach(card=>{
    const text = (card.innerText || '').toLowerCase();
    card.style.display = text.includes(term) ? '' : 'none';
  });
  document.querySelectorAll('.topics a').forEach(a=>{
    a.style.display = a.textContent.toLowerCase().includes(term) ? '' : 'none';
  });
});

/* ---------- Dark mode toggle ---------- */
const darkToggle = document.getElementById('darkToggle');
const body = document.body;
function setDark(on){
  if(on) body.classList.add('dark'), darkToggle.textContent='â˜€ï¸ Light';
  else body.classList.remove('dark'), darkToggle.textContent='ðŸŒ™ Dark Mode';
}
// preserve in localStorage
const saved = localStorage.getItem('ax-faq-dark');
setDark(saved === '1');

darkToggle.addEventListener('click', ()=>{
  const isDark = body.classList.toggle('dark');
  darkToggle.textContent = isDark ? 'â˜€ï¸ Light' : 'ðŸŒ™ Dark Mode';
  localStorage.setItem('ax-faq-dark', isDark ? '1' : '0');
});

/* ---------- Home / Logo handlers ---------- */
document.getElementById('brandLogo').addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));
document.getElementById('homeTop').addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));
document.getElementById('sidebarHome').addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));

/* ---------- Back to top ---------- */
const topBtn = document.getElementById('topBtn');
window.addEventListener('scroll', ()=>{
  topBtn.style.display = window.scrollY > 240 ? 'block' : 'none';
});
topBtn.addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));

/* ---------- Smooth anchor when page loaded with hash ---------- */
window.addEventListener('load', ()=>{
  if(location.hash){
    const el = document.querySelector(location.hash);
    if(el) setTimeout(()=>el.scrollIntoView({behavior:'smooth', block:'start'}), 260);
  }
});

/* Accessibility: keyboard expand/collapse (Enter/Space on focused cards) */
document.addEventListener('keydown', (e)=>{
  if(!['Enter',' '].includes(e.key)) return;
  const active = document.activeElement;
  if(active && active.classList.contains && active.classList.contains('card')){
    e.preventDefault();
    active.click();
  }
});

/* Make cards focusable for keyboard users */
document.querySelectorAll('.card').forEach(c=>{ c.tabIndex = 0; c.setAttribute('role','button'); c.setAttribute('aria-pressed','false'); c.addEventListener('click', ()=>{ const pressed = c.classList.contains('open'); c.setAttribute('aria-pressed', pressed); });});

</script>
</body>
</html>
