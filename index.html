<!-- Updated AXAPTA FAQ HTML (Company logo + home removed, full-width forced for Google Sites) -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AXAPTA Invoice FAQs</title>
<style>
  /* Force full width in Google Sites iframe */
  html, body {
    width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
    overflow-x: hidden !important;
    background: #fffaf9;
    font-family: Inter, Arial, sans-serif;
  }

  :root{
    --bg: #fffaf9;
    --card: #ffffff;
    --text: #111827;
    --muted: #6b7280;
    --accent: #8b0000;
    --accent-2: #b22222;
    --border: #e6e6e6;
    --radius: 12px;
    --shadow: 0 6px 20px rgba(11,15,20,0.08);
  }
  .dark{
    --bg: #0b0f12;
    --card: #0f1720;
    --text: #e6eef6;
    --muted: #9aa7b8;
    --accent: #b22222;
    --accent-2: #8b0000;
    --border: rgba(255,255,255,0.06);
    --shadow: 0 8px 30px rgba(0,0,0,0.6);
  }

  .layout{
    display:flex;gap:28px;padding:28px;width:100%;max-width:100%;
    background:var(--bg);
  }

  .sidebar{
    width:300px;flex:0 0 300px;background:var(--card);
    border-radius:var(--radius);padding:22px;box-shadow:var(--shadow);
    border:1px solid var(--border);position:sticky;top:24px;height:max-content;
  }

  .search input{
    width:100%;padding:12px 14px;border-radius:10px;border:1px solid var(--border);
    background:transparent;color:var(--text);
  }

  .topics a{
    display:block;padding:10px 12px;margin-bottom:8px;
    text-decoration:none;color:var(--accent);font-weight:700;
    border-radius:8px;
  }

  .main{flex:1;width:100%;max-width:100%;}

  .toggle{
    background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;
    padding:8px 12px;border-radius:999px;border:none;font-weight:700;cursor:pointer;
  }

  .faq-wrap{display:grid;grid-template-columns:1fr;gap:16px;width:100%;}

  .card{
    background:var(--card);border-radius:12px;padding:18px;border:1px solid var(--border);
    box-shadow:var(--shadow);
  }

  .q{display:flex;align-items:flex-start;gap:12px;cursor:pointer;}
  .q h3{margin:0;font-size:16px;color:var(--accent)}
  .meta-line{font-size:13px;color:var(--muted);}
  .answer{margin-top:12px;display:none;line-height:1.55;color:var(--text)}
  .open .answer{display:block}

  #topBtn{
    position:fixed;right:28px;bottom:28px;background:var(--accent);color:#fff;
    border:none;padding:12px 14px;border-radius:999px;cursor:pointer;
    display:none;font-weight:700;
  }
</style>
</head>
<body>

<div class="layout">
  <aside class="sidebar">
    <div class="search"><input id="search" type="search" placeholder="Search FAQ..."></div>
    <nav class="topics"></nav>
  </aside>

  <main class="main">
    <button id="darkToggle" class="toggle">ðŸŒ™ Dark Mode</button>
    <section id="faqs" class="faq-wrap"></section>
  </main>
</div>

<button id="topBtn">â†‘ Top</button>

<script>
/* ------------------ FULL FAQ DATA (from AX FAQs.docx) ------------------ */
const faqs = [
  {
    id: "q-where-validated",
    q: "Where are validated invoices routed once they have been successfully exported from IM-OCR to AX?",
    a: [
      "Invoices that are successfully exported from IM-OCR will interface into AX through the following journals:",
      "â€¢ Invoice Journal for non-PO invoices",
      "â€¢ Invoice Approval Journal for PO invoices",
      "<img src='https://drive.google.com/file/d/1Sz_7F74xmWccFIcenjUNsJUK9PcRURsb' style='width:100%;max-width:520px;border-radius:10px;margin:12px 0;box-shadow:0 4px 16px rgba(0,0,0,0.25);'>"
    ]
  },
  {
    id: "q-restore-cancelled",
    q: "What should I do if I accidentally cancelled an invoice in the Invoice Approval Journal?",
    a: [
      "To restore the invoice:",
      "1. Open the Invoice Approval Journal.",
      "2. Select the invoice cancelled.",
      "3. Click Lines then Remove voucher.",
      "4. Confirm by selecting Yes.",
      "5. Fetch voucher.",
      "6. Click Select then OK to complete the process."
    ]
  },
  {
    id: "q-insufficient-info",
    q: "What does the error message \"Insufficient information / Intercompany posting missing / Update canceled\" mean in AX?",
    a: [
      "This error appears when AX is unable to post an invoice due to missing or incorrect data in the voucher. The Infolog may show messages such as:",
      "\"Insufficient information in a line in voucher ...\" â€“ Required fields (e.g., ledger account, offset account, or financial dimensions) are missing.",
      "\"Intercompany posting with th91 missing.\" â€“ The intercompany setup is incomplete or a required dimension value (e.g., th91) is not defined or mapped correctly.",
      "\"Journal has not been posted / Update has been canceled because of an error.\" â€“ AX stops the posting process because validation failed.",
      "To resolve these errors, ensure all mandatory fields and dimensions are populated. Check intercompany account mappings and required dimensions for the referenced value and correct any missing or invalid data. If the issue persists, please seek assistance from the AX support team."
    ]
  },
  {
    id: "q-no-budget",
    q: "To whom should I coordinate if a \"no budget\" error occurs during invoice posting?",
    a: [
      "Coordinate with the Requestors or Marketing Coordinators so they can top up the budget. Once the budget has been updated, you can proceed to post the invoice."
    ]
  },
  {
    id: "q-invoice-higher-than-grn",
    q: "How do I handle an invoice in AX when the invoice amount is higher than the PO GRN amount?",
    a: [
      "Ask the requestor to create an additional Purchase Order (PO) for the excess amount. Once the additional PO number is provided, follow these steps:",
      "1. Go to the Invoice Approval Journal in AX.",
      "2. Select Functions â†’ Purchase Order.",
      "3. Click the Select tab.",
      "4. Tick the additional PO number.",
      "5. Arrange the sequence as needed.",
      "You can now post the invoice successfully."
    ]
  },
  {
    id: "q-inventitemprice",
    q: "What does the error \"Cannot create a record in Price (InventItemPrice). Item Number RBMENSYMVN006.\" mean in AX?",
    a: [
      "This error indicates that AX is unable to create or update a price record for the specified item (RBMENSYMVN006) in the InventItemPrice table. Common causes include:",
      "â€¢ The item number does not exist or is inactive in the system.",
      "â€¢ Required pricing setup (such as price groups or units of measure) is missing or incorrect.",
      "â€¢ Insufficient user permissions to create or modify price records.",
      "To resolve this error, raise this to the AX support team as the finance team does not have sufficient access to investigate the item setup."
    ]
  },
  {
    id: "q-ledger-incorrect",
    q: "The ledger account tagged in the PO is incorrect; how can I correct it during invoice posting?",
    a: [
      "To correct the ledger account during invoice posting:",
      "1. Go to the Invoice Approval Journal in AX.",
      "2. Click Lines and select the invoice to post.",
      "3. Navigate to the Information tab.",
      "4. For Opex accounts, enter the correct ledger account in the Ledger Account field.",
      "5. For A&M, enter the correct ledger account in the Category field."
    ]
  },
  {
    id: "q-po-dimension-mismatch",
    q: "What should I do if the PO dimension does not match the project master in AX?",
    a: [
      "If the dimensions set in the PO do not match the project master, requestors should:",
      "â€¢ Verify the project dimensions in the project master.",
      "â€¢ Update the PO line with the correct project or financial dimensions to match the project master.",
      "â€¢ Ensure that all required fields (Cost Center, Department, Project ID, etc.) are consistent.",
      "If the mismatch persists, raise the issue to the AX support team for assistance, as correcting project dimension setups may require administrative access."
    ]
  },
  {
    id: "q-not-in-journal",
    q: "Where can I find an invoice exported from IM-OCR to AX if it does not appear in the Invoice Journal or Invoice Approval Journal?",
    a: [
      "If an invoice exported from IM-OCR does not appear in the Invoice Journal or Invoice Approval Journal, it may not have been successfully interfaced into AX. To locate it:",
      "â€¢ Check the Invoice Processing Log in AX to see the current status of the invoice.",
      "  â€“ AP Invoice Processing Log - for Non-PO invoices.",
      "  â€“ PO Invoice Processing Log - for PO invoices.",
      "â€¢ Created â€“ The invoice has been generated but not yet posted.",
      "â€¢ Failed â€“ There was an error during the interface process.",
      "If the status shows Failed, identify the error details in the log and correct any missing or invalid information. Once the issue is resolved, the invoice can be re-processed.",
      "If the invoice still cannot be found, contact the AX support team for assistance."
    ]
  },
  {
    id: "q-closed-period",
    q: "What should I do if the invoice cannot be posted in AX due to a closed period?",
    a: [
      "If the invoice cannot be posted because the period is closed:",
      "1. Check the posting date used for the invoice in AX.",
      "2. Update the posting date to a date within an open period.",
      "3. Attempt to post the invoice again after updating the date."
    ]
  },
  {
    id: "q-po-number-invalid",
    q: "How do I resolve the AX interface error \"Line Item 1.00 â€“ PO Number NPOXX-00XXX is invalid\"?",
    a: [
      "This error appears when the PO number captured in IM-OCR does not match a valid PO in AX. To resolve it:",
      "â€¢ Verify the PO number in the invoice and ensure it matches exactly with the PO created in AX.",
      "â€¢ Confirm that the PO exists in AX, is open, and has not been cancelled.",
      "If the PO number is correct but still returns an \"invalid\" error, the issue may be due to incorrect PO setup or missing data in AX. In such cases, escalate the issue to the AX support team, as system-side corrections may be required.",
      "To prevent this interface error in AX, the item number in IM-OCR has to be updated manually."
    ]
  },
  {
    id: "q-dimension-error",
    q: "How do I resolve a dimension error such as \"Business Line/PRIN-PROD combination failing financial dimension\" in AX?",
    a: [
      "This error occurs when the financial dimensions used in the PO line do not match a valid or allowed dimension combination in AX. To resolve it:",
      "1. Check the financial dimensions (e.g., Business Line, PRIN, Product, Cost Center) assigned to the line.",
      "2. Verify whether the dimension combination is valid based on the defined dimension rules.",
      "3. Update the dimension in the AX PO module with the correct combination.",
      "4. Re-process the invoice from the Invoice Processing Log."
    ]
  },
  {
    id: "q-material-invalid",
    q: "How do I resolve the AX interface error \"Material Number is invalid\"?",
    a: [
      "To resolve this:",
      "â€¢ Verify the material/item number on the invoice and ensure it is correctly encoded in IM-OCR.",
      "â€¢ Check if the item number exists and is active in AX.",
      "â€¢ If the material number should be valid but still returns an error, the item master setup may be incomplete.",
      "During invoice validation, if you are unsure of the material number, leave the field blank to avoid this error.",
      "As the Finance team does not have access to modify item master data, raise this issue to the AX support team for validation and correction."
    ]
  }
];


/* ------------------ RENDER FAQ + SEARCH + ACCORDION ------------------ */
const topicsEl = document.querySelector('.topics');
const faqsEl = document.getElementById('faqs');

function renderAll(){
  topicsEl.innerHTML = '';
  faqsEl.innerHTML = '';

  faqs.forEach(item=>{
    const link = document.createElement('a');
    link.href = '#' + item.id;
    link.textContent = item.q;
    link.onclick = e => {
      e.preventDefault();
      document.getElementById(item.id).scrollIntoView({behavior:'smooth'});
    };
    topicsEl.appendChild(link);

    const card = document.createElement('article');
    card.className = 'card';
    card.id = item.id;

    const qWrap = document.createElement('div');
    qWrap.className = 'q';

    const h = document.createElement('h3');
    h.textContent = item.q;
    qWrap.appendChild(h);

    const summary = document.createElement('p');
    summary.className = 'meta-line';
    summary.textContent = item.a[0];

    const ans = document.createElement('div');
    ans.className = 'answer';
    item.a.forEach(t=>{
      const p = document.createElement('p'); p.textContent = t; ans.appendChild(p);
      p.innerHTML = line;     // âœ… dito gumagana ang <img>, <b>, etc.
  ans.appendChild(p);
    });

    card.appendChild(qWrap);
    card.appendChild(summary);
    card.appendChild(ans);

    card.addEventListener('click',()=>{
      card.classList.toggle('open');
    });

    faqsEl.appendChild(card);
  });
}
renderAll();

/* ------------------ SEARCH ------------------ */
document.getElementById('search').addEventListener('input', function(){
  let term = this.value.toLowerCase();
  document.querySelectorAll('.card').forEach(c=>{
    const text = c.innerText.toLowerCase();
    c.style.display = text.includes(term) ? '' : 'none';
  });
  document.querySelectorAll('.topics a').forEach(a=>{
    a.style.display = a.innerText.toLowerCase().includes(term) ? '' : 'none';
  });
});

/*/* ------------------ DARK MODE ------------------ */
const darkToggle = document.getElementById('darkToggle');
function applyDark(d){
  if(d) document.body.classList.add('dark'); else document.body.classList.remove('dark');
  darkToggle.textContent = d ? 'â˜€ï¸ Light Mode' : 'ðŸŒ™ Dark Mode';
}
applyDark(false);

darkToggle.addEventListener('click',()=>{
  const isDark = document.body.classList.toggle('dark');
  darkToggle.textContent = isDark ? 'â˜€ï¸ Light Mode' : 'ðŸŒ™ Dark Mode';
});

/* ------------------ BACK TO TOP ------------------ */
const topBtn = document.getElementById('topBtn');
window.addEventListener('scroll',()=>{
  topBtn.style.display = window.scrollY > 300 ? 'block' : 'none';
});
topBtn.onclick = ()=>window.scrollTo({top:0,behavior:'smooth'});

</script> ------------------ */
const darkToggle = document.getElementById('darkToggle');
function applyDark(d){
  if(d) document.body.classList.add('dark'); else document.body
</body>
</html>
